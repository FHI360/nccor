L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:false,noWrap:false,mapOptions:{backgroundColor:"#dddddd"}},initialize:function(e,t){L.Util.setOptions(this,t);this._ready=google.maps.Map!=undefined;if(!this._ready)L.Google.asyncWait.push(this);this._type=e||"SATELLITE"},onAdd:function(e,t){this._map=e;this._insertAtTheBottom=t;this._initContainer();this._initMapObject();e.on("viewreset",this._resetCallback,this);this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this);e.on("move",this._update,this);e.on("zoomanim",this._handleZoomAnim,this);e._controlCorners["bottomright"].style.marginBottom="20px";this._reset();this._update()},onRemove:function(e){this._map._container.removeChild(this._container);this._map.off("viewreset",this._resetCallback,this);this._map.off("move",this._update,this);this._map.off("zoomanim",this._handleZoomAnim,this);e._controlCorners["bottomright"].style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(e){this.options.opacity=e;if(e<1){L.DomUtil.setOpacity(this._container,e)}},setElementSize:function(e,t){e.style.width=t.x+"px";e.style.height=t.y+"px"},_initContainer:function(){var e=this._map._container,t=e.firstChild;if(!this._container){this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left");this._container.id="_GMapContainer_"+L.Util.stamp(this);this._container.style.zIndex="auto"}if(true){e.insertBefore(this._container,t);this.setOpacity(this.options.opacity);this.setElementSize(this._container,this._map.getSize())}},_initMapObject:function(){if(!this._ready)return;this._google_center=new google.maps.LatLng(0,0);var e=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false,styles:this.options.mapOptions.styles,backgroundColor:this.options.mapOptions.backgroundColor});var t=this;this._reposition=google.maps.event.addListenerOnce(e,"center_changed",function(){t.onReposition()});this._google=e;google.maps.event.addListenerOnce(e,"idle",function(){t._checkZoomLevels()})},_checkZoomLevels:function(){if(this._google.getZoom()!==this._map.getZoom()){this._map.setZoom(this._google.getZoom())}},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){this._initContainer()},_update:function(e){if(!this._google)return;this._resize();var t=e&&e.latlng?e.latlng:this._map.getCenter();var n=new google.maps.LatLng(t.lat,t.lng);this._google.setCenter(n);this._google.setZoom(this._map.getZoom());this._checkZoomLevels()},_resize:function(){var e=this._map.getSize();if(this._container.style.width==e.x&&this._container.style.height==e.y)return;this.setElementSize(this._container,e);this.onReposition()},_handleZoomAnim:function(e){var t=e.center;var n=new google.maps.LatLng(t.lat,t.lng);this._google.setCenter(n);this._google.setZoom(e.zoom)},onReposition:function(){if(!this._google)return;google.maps.event.trigger(this._google,"resize")}});L.Google.asyncWait=[];L.Google.asyncInitialize=function(){var e;for(e=0;e<L.Google.asyncWait.length;e++){var t=L.Google.asyncWait[e];t._ready=true;if(t._container){t._initMapObject();t._update()}}L.Google.asyncWait=[]}